/*! 
  Alkemio Visualization v1.0.2
  ----------------------------------------
  Copyright (c) 2022 Alkemio Foundation.
  Homepage: https://alkemio.foundation
  Released under the EUPL-1.2 License.

  License information can be found in LICENSE.txt.
 */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("@alkemio/visualization",[],n):"object"==typeof exports?exports["@alkemio/visualization"]=n():t["@alkemio/visualization"]=n()}(this,(()=>(()=>{"use strict";var t={d:(n,e)=>{for(var r in e)t.o(e,r)&&!t.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:e[r]})},o:(t,n)=>Object.prototype.hasOwnProperty.call(t,n),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},n={};function e(){}function r(t){return null==t?e:function(){return this.querySelector(t)}}function i(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function o(){return[]}function a(t){return null==t?o:function(){return this.querySelectorAll(t)}}function s(t){return function(){return this.matches(t)}}function u(t){return function(n){return n.matches(t)}}t.r(n),t.d(n,{LifecycleDataProvider:()=>Vi,LifecycleVisualization:()=>tr});var c=Array.prototype.find;function l(){return this.firstElementChild}var h=Array.prototype.filter;function f(){return Array.from(this.children)}function p(t){return new Array(t.length)}function d(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}function v(t){return function(){return t}}function y(t,n,e,r,i,o){for(var a,s=0,u=n.length,c=o.length;s<c;++s)(a=n[s])?(a.__data__=o[s],r[s]=a):e[s]=new d(t,o[s]);for(;s<u;++s)(a=n[s])&&(i[s]=a)}function g(t,n,e,r,i,o,a){var s,u,c,l=new Map,h=n.length,f=o.length,p=new Array(h);for(s=0;s<h;++s)(u=n[s])&&(p[s]=c=a.call(u,u.__data__,s,n)+"",l.has(c)?i[s]=u:l.set(c,u));for(s=0;s<f;++s)c=a.call(t,o[s],s,o)+"",(u=l.get(c))?(r[s]=u,u.__data__=o[s],l.delete(c)):e[s]=new d(t,o[s]);for(s=0;s<h;++s)(u=n[s])&&l.get(p[s])===u&&(i[s]=u)}function m(t){return t.__data__}function _(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function x(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}d.prototype={constructor:d,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var w="http://www.w3.org/1999/xhtml";const b={svg:"http://www.w3.org/2000/svg",xhtml:w,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function S(t){var n=t+="",e=n.indexOf(":");return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),b.hasOwnProperty(n)?{space:b[n],local:t}:t}function k(t){return function(){this.removeAttribute(t)}}function N(t){return function(){this.removeAttributeNS(t.space,t.local)}}function A(t,n){return function(){this.setAttribute(t,n)}}function E(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function O(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}function M(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function j(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function P(t){return function(){this.style.removeProperty(t)}}function D(t,n,e){return function(){this.style.setProperty(t,n,e)}}function $(t,n,e){return function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}function C(t,n){return t.style.getPropertyValue(n)||j(t).getComputedStyle(t,null).getPropertyValue(n)}function T(t){return function(){delete this[t]}}function V(t,n){return function(){this[t]=n}}function I(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}function q(t){return t.trim().split(/^|\s+/)}function R(t){return t.classList||new L(t)}function L(t){this._node=t,this._names=q(t.getAttribute("class")||"")}function X(t,n){for(var e=R(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function z(t,n){for(var e=R(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function B(t){return function(){X(this,t)}}function H(t){return function(){z(this,t)}}function G(t,n){return function(){(n.apply(this,arguments)?X:z)(this,t)}}function Y(){this.textContent=""}function F(t){return function(){this.textContent=t}}function J(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}function U(){this.innerHTML=""}function W(t){return function(){this.innerHTML=t}}function K(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}function Q(){this.nextSibling&&this.parentNode.appendChild(this)}function Z(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function tt(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===w&&n.documentElement.namespaceURI===w?n.createElement(t):n.createElementNS(e,t)}}function nt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function et(t){var n=S(t);return(n.local?nt:tt)(n)}function rt(){return null}function it(){var t=this.parentNode;t&&t.removeChild(this)}function ot(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function at(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function st(t){return t.trim().split(/^|\s+/).map((function(t){var n="",e=t.indexOf(".");return e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}}))}function ut(t){return function(){var n=this.__on;if(n){for(var e,r=0,i=-1,o=n.length;r<o;++r)e=n[r],t.type&&e.type!==t.type||e.name!==t.name?n[++i]=e:this.removeEventListener(e.type,e.listener,e.options);++i?n.length=i:delete this.__on}}}function ct(t,n,e){return function(){var r,i=this.__on,o=function(t){return function(n){t.call(this,n,this.__data__)}}(n);if(i)for(var a=0,s=i.length;a<s;++a)if((r=i[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=e),void(r.value=n);this.addEventListener(t.type,o,e),r={type:t.type,name:t.name,value:n,listener:o,options:e},i?i.push(r):this.__on=[r]}}function lt(t,n,e){var r=j(t),i=r.CustomEvent;"function"==typeof i?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}function ht(t,n){return function(){return lt(this,t,n)}}function ft(t,n){return function(){return lt(this,t,n.apply(this,arguments))}}L.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var pt=[null];function dt(t,n){this._groups=t,this._parents=n}function vt(){return new dt([[document.documentElement]],pt)}dt.prototype=vt.prototype={constructor:dt,select:function(t){"function"!=typeof t&&(t=r(t));for(var n=this._groups,e=n.length,i=new Array(e),o=0;o<e;++o)for(var a,s,u=n[o],c=u.length,l=i[o]=new Array(c),h=0;h<c;++h)(a=u[h])&&(s=t.call(a,a.__data__,h,u))&&("__data__"in a&&(s.__data__=a.__data__),l[h]=s);return new dt(i,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return i(t.apply(this,arguments))}}(t):a(t);for(var n=this._groups,e=n.length,r=[],o=[],s=0;s<e;++s)for(var u,c=n[s],l=c.length,h=0;h<l;++h)(u=c[h])&&(r.push(t.call(u,u.__data__,h,c)),o.push(u));return new dt(r,o)},selectChild:function(t){return this.select(null==t?l:function(t){return function(){return c.call(this.children,t)}}("function"==typeof t?t:u(t)))},selectChildren:function(t){return this.selectAll(null==t?f:function(t){return function(){return h.call(this.children,t)}}("function"==typeof t?t:u(t)))},filter:function(t){"function"!=typeof t&&(t=s(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a=n[i],u=a.length,c=r[i]=[],l=0;l<u;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&c.push(o);return new dt(r,this._parents)},data:function(t,n){if(!arguments.length)return Array.from(this,m);var e=n?g:y,r=this._parents,i=this._groups;"function"!=typeof t&&(t=v(t));for(var o=i.length,a=new Array(o),s=new Array(o),u=new Array(o),c=0;c<o;++c){var l=r[c],h=i[c],f=h.length,p=_(t.call(l,l&&l.__data__,c,r)),d=p.length,x=s[c]=new Array(d),w=a[c]=new Array(d),b=u[c]=new Array(f);e(l,h,x,w,b,p,n);for(var S,k,N=0,A=0;N<d;++N)if(S=x[N]){for(N>=A&&(A=N+1);!(k=w[A])&&++A<d;);S._next=k||null}}return(a=new dt(a,r))._enter=s,a._exit=u,a},enter:function(){return new dt(this._enter||this._groups.map(p),this._parents)},exit:function(){return new dt(this._exit||this._groups.map(p),this._parents)},join:function(t,n,e){var r=this.enter(),i=this,o=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=n&&(i=n(i))&&(i=i.selection()),null==e?o.remove():e(o),r&&i?r.merge(i).order():i},merge:function(t){for(var n=t.selection?t.selection():t,e=this._groups,r=n._groups,i=e.length,o=r.length,a=Math.min(i,o),s=new Array(i),u=0;u<a;++u)for(var c,l=e[u],h=r[u],f=l.length,p=s[u]=new Array(f),d=0;d<f;++d)(c=l[d]||h[d])&&(p[d]=c);for(;u<i;++u)s[u]=e[u];return new dt(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r,i=t[n],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function n(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}t||(t=x);for(var e=this._groups,r=e.length,i=new Array(r),o=0;o<r;++o){for(var a,s=e[o],u=s.length,c=i[o]=new Array(u),l=0;l<u;++l)(a=s[l])&&(c[l]=a);c.sort(n)}return new dt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){let t=0;for(const n of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i,o=n[e],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,n){var e=S(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((null==n?e.local?N:k:"function"==typeof n?e.local?M:O:e.local?E:A)(e,n))},style:function(t,n,e){return arguments.length>1?this.each((null==n?P:"function"==typeof n?$:D)(t,n,null==e?"":e)):C(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?T:"function"==typeof n?I:V)(t,n)):this.node()[t]},classed:function(t,n){var e=q(t+"");if(arguments.length<2){for(var r=R(this.node()),i=-1,o=e.length;++i<o;)if(!r.contains(e[i]))return!1;return!0}return this.each(("function"==typeof n?G:n?B:H)(e,n))},text:function(t){return arguments.length?this.each(null==t?Y:("function"==typeof t?J:F)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?U:("function"==typeof t?K:W)(t)):this.node().innerHTML},raise:function(){return this.each(Q)},lower:function(){return this.each(Z)},append:function(t){var n="function"==typeof t?t:et(t);return this.select((function(){return this.appendChild(n.apply(this,arguments))}))},insert:function(t,n){var e="function"==typeof t?t:et(t),i=null==n?rt:"function"==typeof n?n:r(n);return this.select((function(){return this.insertBefore(e.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(it)},clone:function(t){return this.select(t?at:ot)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var r,i,o=st(t+""),a=o.length;if(!(arguments.length<2)){for(s=n?ct:ut,r=0;r<a;++r)this.each(s(o[r],n,e));return this}var s=this.node().__on;if(s)for(var u,c=0,l=s.length;c<l;++c)for(r=0,u=s[c];r<a;++r)if((i=o[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(t,n){return this.each(("function"==typeof n?ft:ht)(t,n))},[Symbol.iterator]:function*(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r,i=t[n],o=0,a=i.length;o<a;++o)(r=i[o])&&(yield r)}};const yt=vt;var gt={value:()=>{}};function mt(){for(var t,n=0,e=arguments.length,r={};n<e;++n){if(!(t=arguments[n]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new _t(r)}function _t(t){this._=t}function xt(t,n){return t.trim().split(/^|\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))}function wt(t,n){for(var e,r=0,i=t.length;r<i;++r)if((e=t[r]).name===n)return e.value}function bt(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=gt,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=e&&t.push({name:n,value:e}),t}_t.prototype=mt.prototype={constructor:_t,on:function(t,n){var e,r=this._,i=xt(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++o<a;)if(e=(t=i[o]).type)r[e]=bt(r[e],t.name,n);else if(null==n)for(e in r)r[e]=bt(r[e],t.name,null);return this}for(;++o<a;)if((e=(t=i[o]).type)&&(e=wt(r[e],t.name)))return e},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new _t(t)},call:function(t,n){if((e=arguments.length-2)>0)for(var e,r,i=new Array(e),o=0;o<e;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,e=(r=this._[t]).length;o<e;++o)r[o].value.apply(n,i)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(n,e)}};const St=mt;var kt,Nt,At=0,Et=0,Ot=0,Mt=0,jt=0,Pt=0,Dt="object"==typeof performance&&performance.now?performance:Date,$t="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ct(){return jt||($t(Tt),jt=Dt.now()+Pt)}function Tt(){jt=0}function Vt(){this._call=this._time=this._next=null}function It(t,n,e){var r=new Vt;return r.restart(t,n,e),r}function qt(){jt=(Mt=Dt.now())+Pt,At=Et=0;try{!function(){Ct(),++At;for(var t,n=kt;n;)(t=jt-n._time)>=0&&n._call.call(void 0,t),n=n._next;--At}()}finally{At=0,function(){var t,n,e=kt,r=1/0;for(;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:kt=n);Nt=t,Lt(r)}(),jt=0}}function Rt(){var t=Dt.now(),n=t-Mt;n>1e3&&(Pt-=n,Mt=t)}function Lt(t){At||(Et&&(Et=clearTimeout(Et)),t-jt>24?(t<1/0&&(Et=setTimeout(qt,t-Dt.now()-Pt)),Ot&&(Ot=clearInterval(Ot))):(Ot||(Mt=Dt.now(),Ot=setInterval(Rt,1e3)),At=1,$t(qt)))}function Xt(t,n,e){var r=new Vt;return n=null==n?0:+n,r.restart((e=>{r.stop(),t(e+n)}),n,e),r}Vt.prototype=It.prototype={constructor:Vt,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?Ct():+e)+(null==n?0:+n),this._next||Nt===this||(Nt?Nt._next=this:kt=this,Nt=this),this._call=t,this._time=e,Lt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Lt())}};var zt=St("start","end","cancel","interrupt"),Bt=[];function Ht(t,n,e,r,i,o){var a=t.__transition;if(a){if(e in a)return}else t.__transition={};!function(t,n,e){var r,i=t.__transition;function o(t){e.state=1,e.timer.restart(a,e.delay,e.time),e.delay<=t&&a(t-e.delay)}function a(o){var c,l,h,f;if(1!==e.state)return u();for(c in i)if((f=i[c]).name===e.name){if(3===f.state)return Xt(a);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete i[c]):+c<n&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete i[c])}if(Xt((function(){3===e.state&&(e.state=4,e.timer.restart(s,e.delay,e.time),s(o))})),e.state=2,e.on.call("start",t,t.__data__,e.index,e.group),2===e.state){for(e.state=3,r=new Array(h=e.tween.length),c=0,l=-1;c<h;++c)(f=e.tween[c].value.call(t,t.__data__,e.index,e.group))&&(r[++l]=f);r.length=l+1}}function s(n){for(var i=n<e.duration?e.ease.call(null,n/e.duration):(e.timer.restart(u),e.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===e.state&&(e.on.call("end",t,t.__data__,e.index,e.group),u())}function u(){for(var r in e.state=6,e.timer.stop(),delete i[n],i)return;delete t.__transition}i[n]=e,e.timer=It(o,0,e.time)}(t,e,{name:n,index:r,group:i,on:zt,tween:Bt,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function Gt(t,n){var e=Ft(t,n);if(e.state>0)throw new Error("too late; already scheduled");return e}function Yt(t,n){var e=Ft(t,n);if(e.state>3)throw new Error("too late; already running");return e}function Ft(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function Jt(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}var Ut,Wt=180/Math.PI,Kt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Qt(t,n,e,r,i,o){var a,s,u;return(a=Math.sqrt(t*t+n*n))&&(t/=a,n/=a),(u=t*e+n*r)&&(e-=t*u,r-=n*u),(s=Math.sqrt(e*e+r*r))&&(e/=s,r/=s,u/=s),t*r<n*e&&(t=-t,n=-n,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(n,t)*Wt,skewX:Math.atan(u)*Wt,scaleX:a,scaleY:s}}function Zt(t,n,e,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],u=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var u=a.push("translate(",null,n,null,e);s.push({i:u-4,x:Jt(t,i)},{i:u-2,x:Jt(r,o)})}else(i||o)&&a.push("translate("+i+n+o+e)}(o.translateX,o.translateY,a.translateX,a.translateY,s,u),function(t,n,e,o){t!==n?(t-n>180?n+=360:n-t>180&&(t+=360),o.push({i:e.push(i(e)+"rotate(",null,r)-2,x:Jt(t,n)})):n&&e.push(i(e)+"rotate("+n+r)}(o.rotate,a.rotate,s,u),function(t,n,e,o){t!==n?o.push({i:e.push(i(e)+"skewX(",null,r)-2,x:Jt(t,n)}):n&&e.push(i(e)+"skewX("+n+r)}(o.skewX,a.skewX,s,u),function(t,n,e,r,o,a){if(t!==e||n!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:Jt(t,e)},{i:s-2,x:Jt(n,r)})}else 1===e&&1===r||o.push(i(o)+"scale("+e+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,u),o=a=null,function(t){for(var n,e=-1,r=u.length;++e<r;)s[(n=u[e]).i]=n.x(t);return s.join("")}}}var tn=Zt((function(t){const n=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?Kt:Qt(n.a,n.b,n.c,n.d,n.e,n.f)}),"px, ","px)","deg)"),nn=Zt((function(t){return null==t?Kt:(Ut||(Ut=document.createElementNS("http://www.w3.org/2000/svg","g")),Ut.setAttribute("transform",t),(t=Ut.transform.baseVal.consolidate())?Qt((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Kt)}),", ",")",")");function en(t,n){var e,r;return function(){var i=Yt(this,t),o=i.tween;if(o!==e)for(var a=0,s=(r=e=o).length;a<s;++a)if(r[a].name===n){(r=r.slice()).splice(a,1);break}i.tween=r}}function rn(t,n,e){var r,i;if("function"!=typeof e)throw new Error;return function(){var o=Yt(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:n,value:e},u=0,c=i.length;u<c;++u)if(i[u].name===n){i[u]=s;break}u===c&&i.push(s)}o.tween=i}}function on(t,n,e){var r=t._id;return t.each((function(){var t=Yt(this,r);(t.value||(t.value={}))[n]=e.apply(this,arguments)})),function(t){return Ft(t,r).value[n]}}function an(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function sn(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function un(){}var cn=.7,ln=1/cn,hn="\\s*([+-]?\\d+)\\s*",fn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",pn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",dn=/^#([0-9a-f]{3,8})$/,vn=new RegExp(`^rgb\\(${hn},${hn},${hn}\\)$`),yn=new RegExp(`^rgb\\(${pn},${pn},${pn}\\)$`),gn=new RegExp(`^rgba\\(${hn},${hn},${hn},${fn}\\)$`),mn=new RegExp(`^rgba\\(${pn},${pn},${pn},${fn}\\)$`),_n=new RegExp(`^hsl\\(${fn},${pn},${pn}\\)$`),xn=new RegExp(`^hsla\\(${fn},${pn},${pn},${fn}\\)$`),wn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function bn(){return this.rgb().formatHex()}function Sn(){return this.rgb().formatRgb()}function kn(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=dn.exec(t))?(e=n[1].length,n=parseInt(n[1],16),6===e?Nn(n):3===e?new Mn(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===e?An(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===e?An(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=vn.exec(t))?new Mn(n[1],n[2],n[3],1):(n=yn.exec(t))?new Mn(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=gn.exec(t))?An(n[1],n[2],n[3],n[4]):(n=mn.exec(t))?An(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=_n.exec(t))?Tn(n[1],n[2]/100,n[3]/100,1):(n=xn.exec(t))?Tn(n[1],n[2]/100,n[3]/100,n[4]):wn.hasOwnProperty(t)?Nn(wn[t]):"transparent"===t?new Mn(NaN,NaN,NaN,0):null}function Nn(t){return new Mn(t>>16&255,t>>8&255,255&t,1)}function An(t,n,e,r){return r<=0&&(t=n=e=NaN),new Mn(t,n,e,r)}function En(t){return t instanceof un||(t=kn(t)),t?new Mn((t=t.rgb()).r,t.g,t.b,t.opacity):new Mn}function On(t,n,e,r){return 1===arguments.length?En(t):new Mn(t,n,e,null==r?1:r)}function Mn(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}function jn(){return`#${Cn(this.r)}${Cn(this.g)}${Cn(this.b)}`}function Pn(){const t=Dn(this.opacity);return`${1===t?"rgb(":"rgba("}${$n(this.r)}, ${$n(this.g)}, ${$n(this.b)}${1===t?")":`, ${t})`}`}function Dn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function $n(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Cn(t){return((t=$n(t))<16?"0":"")+t.toString(16)}function Tn(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new In(t,n,e,r)}function Vn(t){if(t instanceof In)return new In(t.h,t.s,t.l,t.opacity);if(t instanceof un||(t=kn(t)),!t)return new In;if(t instanceof In)return t;var n=(t=t.rgb()).r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),o=Math.max(n,e,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=n===o?(e-r)/s+6*(e<r):e===o?(r-n)/s+2:(n-e)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new In(a,s,u,t.opacity)}function In(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function qn(t){return(t=(t||0)%360)<0?t+360:t}function Rn(t){return Math.max(0,Math.min(1,t||0))}function Ln(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}function Xn(t,n,e,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*n+(4-6*o+3*a)*e+(1+3*t+3*o-3*a)*r+a*i)/6}an(un,kn,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:bn,formatHex:bn,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Vn(this).formatHsl()},formatRgb:Sn,toString:Sn}),an(Mn,On,sn(un,{brighter(t){return t=null==t?ln:Math.pow(ln,t),new Mn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?cn:Math.pow(cn,t),new Mn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Mn($n(this.r),$n(this.g),$n(this.b),Dn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:jn,formatHex:jn,formatHex8:function(){return`#${Cn(this.r)}${Cn(this.g)}${Cn(this.b)}${Cn(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Pn,toString:Pn})),an(In,(function(t,n,e,r){return 1===arguments.length?Vn(t):new In(t,n,e,null==r?1:r)}),sn(un,{brighter(t){return t=null==t?ln:Math.pow(ln,t),new In(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?cn:Math.pow(cn,t),new In(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new Mn(Ln(t>=240?t-240:t+120,i,r),Ln(t,i,r),Ln(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new In(qn(this.h),Rn(this.s),Rn(this.l),Dn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Dn(this.opacity);return`${1===t?"hsl(":"hsla("}${qn(this.h)}, ${100*Rn(this.s)}%, ${100*Rn(this.l)}%${1===t?")":`, ${t})`}`}}));const zn=t=>()=>t;function Bn(t,n){return function(e){return t+e*n}}function Hn(t){return 1==(t=+t)?Gn:function(n,e){return e-n?function(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}(n,e,t):zn(isNaN(n)?e:n)}}function Gn(t,n){var e=n-t;return e?Bn(t,e):zn(isNaN(t)?n:t)}const Yn=function t(n){var e=Hn(n);function r(t,n){var r=e((t=On(t)).r,(n=On(n)).r),i=e(t.g,n.g),o=e(t.b,n.b),a=Gn(t.opacity,n.opacity);return function(n){return t.r=r(n),t.g=i(n),t.b=o(n),t.opacity=a(n),t+""}}return r.gamma=t,r}(1);function Fn(t){return function(n){var e,r,i=n.length,o=new Array(i),a=new Array(i),s=new Array(i);for(e=0;e<i;++e)r=On(n[e]),o[e]=r.r||0,a[e]=r.g||0,s[e]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}Fn((function(t){var n=t.length-1;return function(e){var r=e<=0?e=0:e>=1?(e=1,n-1):Math.floor(e*n),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<n-1?t[r+2]:2*o-i;return Xn((e-r/n)*n,a,i,o,s)}})),Fn((function(t){var n=t.length;return function(e){var r=Math.floor(((e%=1)<0?++e:e)*n),i=t[(r+n-1)%n],o=t[r%n],a=t[(r+1)%n],s=t[(r+2)%n];return Xn((e-r/n)*n,i,o,a,s)}}));var Jn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Un=new RegExp(Jn.source,"g");function Wn(t,n){var e,r,i,o=Jn.lastIndex=Un.lastIndex=0,a=-1,s=[],u=[];for(t+="",n+="";(e=Jn.exec(t))&&(r=Un.exec(n));)(i=r.index)>o&&(i=n.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(e=e[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:Jt(e,r)})),o=Un.lastIndex;return o<n.length&&(i=n.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(t){return function(n){return t(n)+""}}(u[0].x):function(t){return function(){return t}}(n):(n=u.length,function(t){for(var e,r=0;r<n;++r)s[(e=u[r]).i]=e.x(t);return s.join("")})}function Kn(t,n){var e;return("number"==typeof n?Jt:n instanceof kn?Yn:(e=kn(n))?(n=e,Yn):Wn)(t,n)}function Qn(t){return function(){this.removeAttribute(t)}}function Zn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function te(t,n,e){var r,i,o=e+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=n(r=a,e)}}function ne(t,n,e){var r,i,o=e+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=n(r=a,e)}}function ee(t,n,e){var r,i,o;return function(){var a,s,u=e(this);if(null!=u)return(a=this.getAttribute(t))===(s=u+"")?null:a===r&&s===i?o:(i=s,o=n(r=a,u));this.removeAttribute(t)}}function re(t,n,e){var r,i,o;return function(){var a,s,u=e(this);if(null!=u)return(a=this.getAttributeNS(t.space,t.local))===(s=u+"")?null:a===r&&s===i?o:(i=s,o=n(r=a,u));this.removeAttributeNS(t.space,t.local)}}function ie(t,n){return function(e){this.setAttribute(t,n.call(this,e))}}function oe(t,n){return function(e){this.setAttributeNS(t.space,t.local,n.call(this,e))}}function ae(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&oe(t,i)),e}return i._value=n,i}function se(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&ie(t,i)),e}return i._value=n,i}function ue(t,n){return function(){Gt(this,t).delay=+n.apply(this,arguments)}}function ce(t,n){return n=+n,function(){Gt(this,t).delay=n}}function le(t,n){return function(){Yt(this,t).duration=+n.apply(this,arguments)}}function he(t,n){return n=+n,function(){Yt(this,t).duration=n}}function fe(t,n){if("function"!=typeof n)throw new Error;return function(){Yt(this,t).ease=n}}function pe(t,n,e){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||"start"===t}))}(n)?Gt:Yt;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(n,e),a.on=i}}var de=yt.prototype.constructor;function ve(t){return function(){this.style.removeProperty(t)}}function ye(t,n,e){return function(r){this.style.setProperty(t,n.call(this,r),e)}}function ge(t,n,e){var r,i;function o(){var o=n.apply(this,arguments);return o!==i&&(r=(i=o)&&ye(t,o,e)),r}return o._value=n,o}function me(t){return function(n){this.textContent=t.call(this,n)}}function _e(t){var n,e;function r(){var r=t.apply(this,arguments);return r!==e&&(n=(e=r)&&me(r)),n}return r._value=t,r}var xe=0;function we(t,n,e,r){this._groups=t,this._parents=n,this._name=e,this._id=r}function be(){return++xe}var Se=yt.prototype;we.prototype=function(t){return yt().transition(t)}.prototype={constructor:we,select:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=r(t));for(var i=this._groups,o=i.length,a=new Array(o),s=0;s<o;++s)for(var u,c,l=i[s],h=l.length,f=a[s]=new Array(h),p=0;p<h;++p)(u=l[p])&&(c=t.call(u,u.__data__,p,l))&&("__data__"in u&&(c.__data__=u.__data__),f[p]=c,Ht(f[p],n,e,p,f,Ft(u,e)));return new we(a,this._parents,n,e)},selectAll:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=a(t));for(var r=this._groups,i=r.length,o=[],s=[],u=0;u<i;++u)for(var c,l=r[u],h=l.length,f=0;f<h;++f)if(c=l[f]){for(var p,d=t.call(c,c.__data__,f,l),v=Ft(c,e),y=0,g=d.length;y<g;++y)(p=d[y])&&Ht(p,n,e,y,d,v);o.push(d),s.push(c)}return new we(o,s,n,e)},selectChild:Se.selectChild,selectChildren:Se.selectChildren,filter:function(t){"function"!=typeof t&&(t=s(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a=n[i],u=a.length,c=r[i]=[],l=0;l<u;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&c.push(o);return new we(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var u,c=n[s],l=e[s],h=c.length,f=a[s]=new Array(h),p=0;p<h;++p)(u=c[p]||l[p])&&(f[p]=u);for(;s<r;++s)a[s]=n[s];return new we(a,this._parents,this._name,this._id)},selection:function(){return new de(this._groups,this._parents)},transition:function(){for(var t=this._name,n=this._id,e=be(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],u=s.length,c=0;c<u;++c)if(a=s[c]){var l=Ft(a,n);Ht(a,t,e,c,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new we(r,this._parents,t,e)},call:Se.call,nodes:Se.nodes,node:Se.node,size:Se.size,empty:Se.empty,each:Se.each,on:function(t,n){var e=this._id;return arguments.length<2?Ft(this.node(),e).on.on(t):this.each(pe(e,t,n))},attr:function(t,n){var e=S(t),r="transform"===e?nn:Kn;return this.attrTween(t,"function"==typeof n?(e.local?re:ee)(e,r,on(this,"attr."+t,n)):null==n?(e.local?Zn:Qn)(e):(e.local?ne:te)(e,r,n))},attrTween:function(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==n)return this.tween(e,null);if("function"!=typeof n)throw new Error;var r=S(t);return this.tween(e,(r.local?ae:se)(r,n))},style:function(t,n,e){var r="transform"==(t+="")?tn:Kn;return null==n?this.styleTween(t,function(t,n){var e,r,i;return function(){var o=C(this,t),a=(this.style.removeProperty(t),C(this,t));return o===a?null:o===e&&a===r?i:i=n(e=o,r=a)}}(t,r)).on("end.style."+t,ve(t)):"function"==typeof n?this.styleTween(t,function(t,n,e){var r,i,o;return function(){var a=C(this,t),s=e(this),u=s+"";return null==s&&(this.style.removeProperty(t),u=s=C(this,t)),a===u?null:a===r&&u===i?o:(i=u,o=n(r=a,s))}}(t,r,on(this,"style."+t,n))).each(function(t,n){var e,r,i,o,a="style."+n,s="end."+a;return function(){var u=Yt(this,t),c=u.on,l=null==u.value[a]?o||(o=ve(n)):void 0;c===e&&i===l||(r=(e=c).copy()).on(s,i=l),u.on=r}}(this._id,t)):this.styleTween(t,function(t,n,e){var r,i,o=e+"";return function(){var a=C(this,t);return a===o?null:a===r?i:i=n(r=a,e)}}(t,r,n),e).on("end.style."+t,null)},styleTween:function(t,n,e){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==n)return this.tween(r,null);if("function"!=typeof n)throw new Error;return this.tween(r,ge(t,n,null==e?"":e))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var n=t(this);this.textContent=null==n?"":n}}(on(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;return this.tween(n,_e(t))},remove:function(){return this.on("end.remove",function(t){return function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}}(this._id))},tween:function(t,n){var e=this._id;if(t+="",arguments.length<2){for(var r,i=Ft(this.node(),e).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==n?en:rn)(e,t,n))},delay:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?ue:ce)(n,t)):Ft(this.node(),n).delay},duration:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?le:he)(n,t)):Ft(this.node(),n).duration},ease:function(t){var n=this._id;return arguments.length?this.each(fe(n,t)):Ft(this.node(),n).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,n){return function(){var e=n.apply(this,arguments);if("function"!=typeof e)throw new Error;Yt(this,t).ease=e}}(this._id,t))},end:function(){var t,n,e=this,r=e._id,i=e.size();return new Promise((function(o,a){var s={value:a},u={value:function(){0==--i&&o()}};e.each((function(){var e=Yt(this,r),i=e.on;i!==t&&((n=(t=i).copy())._.cancel.push(s),n._.interrupt.push(s),n._.end.push(u)),e.on=n})),0===i&&o()}))},[Symbol.iterator]:Se[Symbol.iterator]};var ke={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Ne(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))throw new Error(`transition ${n} not found`);return e}yt.prototype.interrupt=function(t){return this.each((function(){!function(t,n){var e,r,i,o=t.__transition,a=!0;if(o){for(i in n=null==n?null:n+"",o)(e=o[i]).name===n?(r=e.state>2&&e.state<5,e.state=6,e.timer.stop(),e.on.call(r?"interrupt":"cancel",t,t.__data__,e.index,e.group),delete o[i]):a=!1;a&&delete t.__transition}}(this,t)}))},yt.prototype.transition=function(t){var n,e;t instanceof we?(n=t._id,t=t._name):(n=be(),(e=ke).time=Ct(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],u=s.length,c=0;c<u;++c)(a=s[c])&&Ht(a,t,n,c,s,e||Ne(a,n));return new we(r,this._parents,t,n)};const{abs:Ae,max:Ee,min:Oe}=Math;function Me(t){return[+t[0],+t[1]]}function je(t){return[Me(t[0]),Me(t[1])]}["w","e"].map(Pe),["n","s"].map(Pe),["n","w","e","s","nw","ne","sw","se"].map(Pe);function Pe(t){return{type:t}}function De(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function $e(t,n,e,r){if(isNaN(n)||isNaN(e))return t;var i,o,a,s,u,c,l,h,f,p=t._root,d={data:r},v=t._x0,y=t._y0,g=t._x1,m=t._y1;if(!p)return t._root=d,t;for(;p.length;)if((c=n>=(o=(v+g)/2))?v=o:g=o,(l=e>=(a=(y+m)/2))?y=a:m=a,i=p,!(p=p[h=l<<1|c]))return i[h]=d,t;if(s=+t._x.call(null,p.data),u=+t._y.call(null,p.data),n===s&&e===u)return d.next=p,i?i[h]=d:t._root=d,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(c=n>=(o=(v+g)/2))?v=o:g=o,(l=e>=(a=(y+m)/2))?y=a:m=a}while((h=l<<1|c)==(f=(u>=a)<<1|s>=o));return i[f]=p,i[h]=d,t}function Ce(t,n,e,r,i){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=i}function Te(t){return t[0]}function Ve(t){return t[1]}function Ie(t,n,e){var r=new qe(null==n?Te:n,null==e?Ve:e,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function qe(t,n,e,r,i,o){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function Re(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var Le=Ie.prototype=qe.prototype;function Xe(t){return function(){return t}}function ze(t){return 1e-6*(t()-.5)}function Be(t){return t.x+t.vx}function He(t){return t.y+t.vy}function Ge(t){return t.index}function Ye(t,n){var e=t.get(n);if(!e)throw new Error("node not found: "+n);return e}Le.copy=function(){var t,n,e=new qe(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return e;if(!r.length)return e._root=Re(r),e;for(t=[{source:r,target:e._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(n=r.source[i])&&(n.length?t.push({source:n,target:r.target[i]=new Array(4)}):r.target[i]=Re(n));return e},Le.add=function(t){const n=+this._x.call(null,t),e=+this._y.call(null,t);return $e(this.cover(n,e),n,e,t)},Le.addAll=function(t){var n,e,r,i,o=t.length,a=new Array(o),s=new Array(o),u=1/0,c=1/0,l=-1/0,h=-1/0;for(e=0;e<o;++e)isNaN(r=+this._x.call(null,n=t[e]))||isNaN(i=+this._y.call(null,n))||(a[e]=r,s[e]=i,r<u&&(u=r),r>l&&(l=r),i<c&&(c=i),i>h&&(h=i));if(u>l||c>h)return this;for(this.cover(u,c).cover(l,h),e=0;e<o;++e)$e(this,a[e],s[e],t[e]);return this},Le.cover=function(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(e))i=(e=Math.floor(t))+1,o=(r=Math.floor(n))+1;else{for(var a,s,u=i-e||1,c=this._root;e>t||t>=i||r>n||n>=o;)switch(s=(n<r)<<1|t<e,(a=new Array(4))[s]=c,c=a,u*=2,s){case 0:i=e+u,o=r+u;break;case 1:e=i-u,o=r+u;break;case 2:i=e+u,r=o-u;break;case 3:e=i-u,r=o-u}this._root&&this._root.length&&(this._root=c)}return this._x0=e,this._y0=r,this._x1=i,this._y1=o,this},Le.data=function(){var t=[];return this.visit((function(n){if(!n.length)do{t.push(n.data)}while(n=n.next)})),t},Le.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Le.find=function(t,n,e){var r,i,o,a,s,u,c,l=this._x0,h=this._y0,f=this._x1,p=this._y1,d=[],v=this._root;for(v&&d.push(new Ce(v,l,h,f,p)),null==e?e=1/0:(l=t-e,h=n-e,f=t+e,p=n+e,e*=e);u=d.pop();)if(!(!(v=u.node)||(i=u.x0)>f||(o=u.y0)>p||(a=u.x1)<l||(s=u.y1)<h))if(v.length){var y=(i+a)/2,g=(o+s)/2;d.push(new Ce(v[3],y,g,a,s),new Ce(v[2],i,g,y,s),new Ce(v[1],y,o,a,g),new Ce(v[0],i,o,y,g)),(c=(n>=g)<<1|t>=y)&&(u=d[d.length-1],d[d.length-1]=d[d.length-1-c],d[d.length-1-c]=u)}else{var m=t-+this._x.call(null,v.data),_=n-+this._y.call(null,v.data),x=m*m+_*_;if(x<e){var w=Math.sqrt(e=x);l=t-w,h=n-w,f=t+w,p=n+w,r=v.data}}return r},Le.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var n,e,r,i,o,a,s,u,c,l,h,f,p=this._root,d=this._x0,v=this._y0,y=this._x1,g=this._y1;if(!p)return this;if(p.length)for(;;){if((c=o>=(s=(d+y)/2))?d=s:y=s,(l=a>=(u=(v+g)/2))?v=u:g=u,n=p,!(p=p[h=l<<1|c]))return this;if(!p.length)break;(n[h+1&3]||n[h+2&3]||n[h+3&3])&&(e=n,f=h)}for(;p.data!==t;)if(r=p,!(p=p.next))return this;return(i=p.next)&&delete p.next,r?(i?r.next=i:delete r.next,this):n?(i?n[h]=i:delete n[h],(p=n[0]||n[1]||n[2]||n[3])&&p===(n[3]||n[2]||n[1]||n[0])&&!p.length&&(e?e[f]=p:this._root=p),this):(this._root=i,this)},Le.removeAll=function(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this},Le.root=function(){return this._root},Le.size=function(){var t=0;return this.visit((function(n){if(!n.length)do{++t}while(n=n.next)})),t},Le.visit=function(t){var n,e,r,i,o,a,s=[],u=this._root;for(u&&s.push(new Ce(u,this._x0,this._y0,this._x1,this._y1));n=s.pop();)if(!t(u=n.node,r=n.x0,i=n.y0,o=n.x1,a=n.y1)&&u.length){var c=(r+o)/2,l=(i+a)/2;(e=u[3])&&s.push(new Ce(e,c,l,o,a)),(e=u[2])&&s.push(new Ce(e,r,l,c,a)),(e=u[1])&&s.push(new Ce(e,c,i,o,l)),(e=u[0])&&s.push(new Ce(e,r,i,c,l))}return this},Le.visitAfter=function(t){var n,e=[],r=[];for(this._root&&e.push(new Ce(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var o,a=n.x0,s=n.y0,u=n.x1,c=n.y1,l=(a+u)/2,h=(s+c)/2;(o=i[0])&&e.push(new Ce(o,a,s,l,h)),(o=i[1])&&e.push(new Ce(o,l,s,u,h)),(o=i[2])&&e.push(new Ce(o,a,h,l,c)),(o=i[3])&&e.push(new Ce(o,l,h,u,c))}r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.y0,n.x1,n.y1);return this},Le.x=function(t){return arguments.length?(this._x=t,this):this._x},Le.y=function(t){return arguments.length?(this._y=t,this):this._y};const Fe=4294967296;function Je(t){return t.x}function Ue(t){return t.y}var We=Math.PI*(3-Math.sqrt(5));function Ke(t){var n,e=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,u=It(h),c=St("tick","end"),l=function(){let t=1;return()=>(t=(1664525*t+1013904223)%Fe)/Fe}();function h(){f(),c.call("tick",n),e<r&&(u.stop(),c.call("end",n))}function f(r){var u,c,l=t.length;void 0===r&&(r=1);for(var h=0;h<r;++h)for(e+=(o-e)*i,s.forEach((function(t){t(e)})),u=0;u<l;++u)null==(c=t[u]).fx?c.x+=c.vx*=a:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=a:(c.y=c.fy,c.vy=0);return n}function p(){for(var n,e=0,r=t.length;e<r;++e){if((n=t[e]).index=e,null!=n.fx&&(n.x=n.fx),null!=n.fy&&(n.y=n.fy),isNaN(n.x)||isNaN(n.y)){var i=10*Math.sqrt(.5+e),o=e*We;n.x=i*Math.cos(o),n.y=i*Math.sin(o)}(isNaN(n.vx)||isNaN(n.vy))&&(n.vx=n.vy=0)}}function d(n){return n.initialize&&n.initialize(t,l),n}return null==t&&(t=[]),p(),n={tick:f,restart:function(){return u.restart(h),n},stop:function(){return u.stop(),n},nodes:function(e){return arguments.length?(t=e,p(),s.forEach(d),n):t},alpha:function(t){return arguments.length?(e=+t,n):e},alphaMin:function(t){return arguments.length?(r=+t,n):r},alphaDecay:function(t){return arguments.length?(i=+t,n):+i},alphaTarget:function(t){return arguments.length?(o=+t,n):o},velocityDecay:function(t){return arguments.length?(a=1-t,n):1-a},randomSource:function(t){return arguments.length?(l=t,s.forEach(d),n):l},force:function(t,e){return arguments.length>1?(null==e?s.delete(t):s.set(t,d(e)),n):s.get(t)},find:function(n,e,r){var i,o,a,s,u,c=0,l=t.length;for(null==r?r=1/0:r*=r,c=0;c<l;++c)(a=(i=n-(s=t[c]).x)*i+(o=e-s.y)*o)<r&&(u=s,r=a);return u},on:function(t,e){return arguments.length>1?(c.on(t,e),n):c.on(t)}}}function Qe(t,n,e){this.k=t,this.x=n,this.y=e}Qe.prototype={constructor:Qe,scale:function(t){return 1===t?this:new Qe(this.k*t,this.x,this.y)},translate:function(t,n){return 0===t&0===n?this:new Qe(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new Qe(1,0,0);Qe.prototype;const Ze={strokeDefaultColor:"#000",strokePrimaryColor:"#068293",font:'"Source Sans Pro"',fontSize:"16px",fillColor:"#F9F9F9"};class tr{constructor(t,n,e,r,i){this.lifecycleData=n,this.svg=function(t){return"string"==typeof t?new dt([[document.querySelector(t)]],[document.documentElement]):new dt([[t]],pt)}(t),this.width=e,this.height=r,this.options=Object.assign(Object.assign({},Ze),i),this.svg.select("*").remove(),this.svg.attr("viewBox",[0,0,this.width,this.height]);const o=this.svg.append("svg:defs");o.append("svg:marker").attr("id","end-arrow").attr("viewBox","0 -5 10 10").attr("refX",10).attr("markerWidth",10.5).attr("markerHeight",10.5).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5");o.append("filter").attr("id","drop-shadow").attr("x",0).attr("y",0).attr("width","200%").attr("height","200%").append("feDropShadow").attr("dx",2).attr("dy",2).attr("stdDeviation",1).attr("flood-color",this.options.strokeDefaultColor).attr("flood-opacity",1)}removeDisplayedLifecycle(){this.simulation&&this.simulation.stop(),this.linksGroup&&this.linksGroup.remove(),this.nodesGroup&&this.nodesGroup.remove(),this.textGroup&&this.textGroup.remove()}displayLifecycle(){var t;const n=120,e=30,r=10,i=this.lifecycleData.machine,o=i.id+"."+(null===(t=i.initial)||void 0===t?void 0:t.toString()),a=this.lifecycleData.graph.children.map((t=>{const n=this.lifecycleData.state&&t.id.endsWith(this.lifecycleData.state)?2:1;return t.id.endsWith(o)?{id:t.id,group:n,fx:70}:"final"===t.stateNode.type?{id:t.id,group:n,fx:this.width-60-10}:{id:t.id,group:n}})),s=this.lifecycleData.graph.children.flatMap((t=>t.edges.map((t=>({source:t.source.id,target:t.target.id})))));this.simulation=Ke(a).force("link",function(t){var n,e,r,i,o,a,s=Ge,u=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},c=Xe(30),l=1;function h(r){for(var i=0,s=t.length;i<l;++i)for(var u,c,h,f,p,d,v,y=0;y<s;++y)c=(u=t[y]).source,f=(h=u.target).x+h.vx-c.x-c.vx||ze(a),p=h.y+h.vy-c.y-c.vy||ze(a),f*=d=((d=Math.sqrt(f*f+p*p))-e[y])/d*r*n[y],p*=d,h.vx-=f*(v=o[y]),h.vy-=p*v,c.vx+=f*(v=1-v),c.vy+=p*v}function f(){if(r){var a,u,c=r.length,l=t.length,h=new Map(r.map(((t,n)=>[s(t,n,r),t])));for(a=0,i=new Array(c);a<l;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=Ye(h,u.source)),"object"!=typeof u.target&&(u.target=Ye(h,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(a=0,o=new Array(l);a<l;++a)u=t[a],o[a]=i[u.source.index]/(i[u.source.index]+i[u.target.index]);n=new Array(l),p(),e=new Array(l),d()}}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+u(t[e],e,t)}function d(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+c(t[n],n,t)}return null==t&&(t=[]),h.initialize=function(t,n){r=t,a=n,f()},h.links=function(n){return arguments.length?(t=n,f(),h):t},h.id=function(t){return arguments.length?(s=t,h):s},h.iterations=function(t){return arguments.length?(l=+t,h):l},h.strength=function(t){return arguments.length?(u="function"==typeof t?t:Xe(+t),p(),h):u},h.distance=function(t){return arguments.length?(c="function"==typeof t?t:Xe(+t),d(),h):c},h}(s).id((t=>t.id))).force("charge",function(){var t,n,e,r,i,o=Xe(-30),a=1,s=1/0,u=.81;function c(e){var i,o=t.length,a=Ie(t,Je,Ue).visitAfter(h);for(r=e,i=0;i<o;++i)n=t[i],a.visit(f)}function l(){if(t){var n,e,r=t.length;for(i=new Array(r),n=0;n<r;++n)e=t[n],i[e.index]=+o(e,n,t)}}function h(t){var n,e,r,o,a,s=0,u=0;if(t.length){for(r=o=a=0;a<4;++a)(n=t[a])&&(e=Math.abs(n.value))&&(s+=n.value,u+=e,r+=e*n.x,o+=e*n.y);t.x=r/u,t.y=o/u}else{(n=t).x=n.data.x,n.y=n.data.y;do{s+=i[n.data.index]}while(n=n.next)}t.value=s}function f(t,o,c,l){if(!t.value)return!0;var h=t.x-n.x,f=t.y-n.y,p=l-o,d=h*h+f*f;if(p*p/u<d)return d<s&&(0===h&&(d+=(h=ze(e))*h),0===f&&(d+=(f=ze(e))*f),d<a&&(d=Math.sqrt(a*d)),n.vx+=h*t.value*r/d,n.vy+=f*t.value*r/d),!0;if(!(t.length||d>=s)){(t.data!==n||t.next)&&(0===h&&(d+=(h=ze(e))*h),0===f&&(d+=(f=ze(e))*f),d<a&&(d=Math.sqrt(a*d)));do{t.data!==n&&(p=i[t.data.index]*r/d,n.vx+=h*p,n.vy+=f*p)}while(t=t.next)}}return c.initialize=function(n,r){t=n,e=r,l()},c.strength=function(t){return arguments.length?(o="function"==typeof t?t:Xe(+t),l(),c):o},c.distanceMin=function(t){return arguments.length?(a=t*t,c):Math.sqrt(a)},c.distanceMax=function(t){return arguments.length?(s=t*t,c):Math.sqrt(s)},c.theta=function(t){return arguments.length?(u=t*t,c):Math.sqrt(u)},c}().strength(-100)).force("collide",function(t){var n,e,r,i=1,o=1;function a(){for(var t,a,u,c,l,h,f,p=n.length,d=0;d<o;++d)for(a=Ie(n,Be,He).visitAfter(s),t=0;t<p;++t)u=n[t],h=e[u.index],f=h*h,c=u.x+u.vx,l=u.y+u.vy,a.visit(v);function v(t,n,e,o,a){var s=t.data,p=t.r,d=h+p;if(!s)return n>c+d||o<c-d||e>l+d||a<l-d;if(s.index>u.index){var v=c-s.x-s.vx,y=l-s.y-s.vy,g=v*v+y*y;g<d*d&&(0===v&&(g+=(v=ze(r))*v),0===y&&(g+=(y=ze(r))*y),g=(d-(g=Math.sqrt(g)))/g*i,u.vx+=(v*=g)*(d=(p*=p)/(f+p)),u.vy+=(y*=g)*d,s.vx-=v*(d=1-d),s.vy-=y*d)}}}function s(t){if(t.data)return t.r=e[t.data.index];for(var n=t.r=0;n<4;++n)t[n]&&t[n].r>t.r&&(t.r=t[n].r)}function u(){if(n){var r,i,o=n.length;for(e=new Array(o),r=0;r<o;++r)i=n[r],e[i.index]=+t(i,r,n)}}return"function"!=typeof t&&(t=Xe(null==t?1:+t)),a.initialize=function(t,e){n=t,r=e,u()},a.iterations=function(t){return arguments.length?(o=+t,a):o},a.strength=function(t){return arguments.length?(i=+t,a):i},a.radius=function(n){return arguments.length?(t="function"==typeof n?n:Xe(+n),u(),a):t},a}().radius(80).iterations(2)).force("center",function(t,n){var e,r=1;function i(){var i,o,a=e.length,s=0,u=0;for(i=0;i<a;++i)s+=(o=e[i]).x,u+=o.y;for(s=(s/a-t)*r,u=(u/a-n)*r,i=0;i<a;++i)(o=e[i]).x-=s,o.y-=u}return null==t&&(t=0),null==n&&(n=0),i.initialize=function(t){e=t},i.x=function(n){return arguments.length?(t=+n,i):t},i.y=function(t){return arguments.length?(n=+t,i):n},i.strength=function(t){return arguments.length?(r=+t,i):r},i}(this.width/2,this.height/2)),this.linksGroup=this.svg.append("g").attr("class","links").attr("stroke",this.options.strokeDefaultColor).attr("stroke-opacity",.6),this.link=this.linksGroup.selectAll("line").data(s).join("line").attr("stroke-width",(t=>1)).style("marker-end","url(#end-arrow)"),this.nodesGroup=this.svg.append("g").attr("class","nodes"),this.node=this.nodesGroup.attr("stroke-width",1.5).selectAll("rect").data(a).enter().append("rect").attr("stroke",(t=>1===t.group?this.options.strokeDefaultColor:this.options.strokePrimaryColor)).attr("width",n).attr("height",e).attr("rx",r).attr("ry",r).attr("fill",this.options.fillColor).style("filter","url(#drop-shadow)"),this.textGroup=this.svg.append("g").attr("class","text").attr("stroke-width",1.5),this.text=this.textGroup.selectAll("text").data(a).enter().append("text").attr("x","50%").attr("y",e).attr("dx",60).attr("dy",15).attr("fill",(t=>1===t.group?this.options.strokeDefaultColor:this.options.strokePrimaryColor)).attr("font-weight",400).attr("font",this.options.font).attr("font-size",this.options.fontSize).attr("text-anchor","middle").attr("dominant-baseline","central").text((t=>t.id.split(".").pop())),this.node.append("title").text((t=>t.id)),this.simulation.on("tick",(()=>{this.link.attr("x1",(t=>{let e=0;if(Math.abs(t.target.x-t.source.x)>n){e=115*Math.sign(t.target.x-t.source.x)/2}return t.source.x+e})).attr("y1",(t=>{let n=0;if(Math.abs(t.target.y-t.source.y)>e){n=25*Math.sign(t.target.y-t.source.y)/2}return t.source.y+n})).attr("x2",(t=>{let e=0;if(Math.abs(t.target.x-t.source.x)>n){e=115*-Math.sign(t.target.x-t.source.x)/2}return t.target.x+e})).attr("y2",(t=>{let n=0;if(Math.abs(t.target.y-t.source.y)>e){n=25*-Math.sign(t.target.y-t.source.y)/2}return t.target.y+n})),this.node.attr("x",(t=>t.x-60)).attr("y",(t=>t.y-15)),this.text.attr("x",(t=>t.x-60)).attr("y",(t=>t.y-15))})),this.simulation.tick(1e3),setTimeout((()=>{this.simulation.stop()}),1)}}var nr=function(){return nr=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t},nr.apply(this,arguments)};function er(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(e[r[i]]=t[r[i]])}return e}function rr(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],r=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function ir(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,i,o=e.call(t),a=[];try{for(;(void 0===n||n-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(i)throw i.error}}return a}function or(t,n,e){if(e||2===arguments.length)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return t.concat(r||Array.prototype.slice.call(n))}var ar,sr={},ur="xstate.guard";function cr(t,n,e){void 0===e&&(e=".");var r=fr(t,e),i=fr(n,e);return Er(i)?!!Er(r)&&i===r:Er(r)?r in i:Object.keys(r).every((function(t){return t in i&&cr(r[t],i[t])}))}function lr(t){try{return Er(t)||"number"==typeof t?"".concat(t):t.type}catch(t){throw new Error("Events must be strings or objects with a string event.type property.")}}function hr(t,n){try{return Nr(t)?t:t.toString().split(n)}catch(n){throw new Error("'".concat(t,"' is not a valid state path."))}}function fr(t,n){return"object"==typeof(e=t)&&"value"in e&&"context"in e&&"event"in e&&"_event"in e?t.value:Nr(t)?pr(t):"string"!=typeof t?t:pr(hr(t,n));var e}function pr(t){if(1===t.length)return t[0];for(var n={},e=n,r=0;r<t.length-1;r++)r===t.length-2?e[t[r]]=t[r+1]:(e[t[r]]={},e=e[t[r]]);return n}function dr(t,n){for(var e={},r=Object.keys(t),i=0;i<r.length;i++){var o=r[i];e[o]=n(t[o],o,t,i)}return e}function vr(t,n,e){var r,i,o={};try{for(var a=rr(Object.keys(t)),s=a.next();!s.done;s=a.next()){var u=s.value,c=t[u];e(c)&&(o[u]=n(c,u,t))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}var yr=function(t){return function(n){var e,r,i=n;try{for(var o=rr(t),a=o.next();!a.done;a=o.next()){i=i[a.value]}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return i}};function gr(t){return t?Er(t)?[[t]]:mr(Object.keys(t).map((function(n){var e=t[n];return"string"==typeof e||e&&Object.keys(e).length?gr(t[n]).map((function(t){return[n].concat(t)})):[[n]]}))):[[]]}function mr(t){var n;return(n=[]).concat.apply(n,or([],ir(t),!1))}function _r(t){return Nr(t)?t:[t]}function xr(t){return void 0===t?[]:_r(t)}function wr(t,n,e){var r,i;if(Ar(t))return t(n,e.data);var o={};try{for(var a=rr(Object.keys(t)),s=a.next();!s.done;s=a.next()){var u=s.value,c=t[u];Ar(c)?o[u]=c(n,e.data):o[u]=c}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}function br(t,n){return dr(t.states,(function(t,e){if(t){var r=(Er(n)?void 0:n[e])||(t?t.current:void 0);if(r)return{current:r,states:br(t,r)}}}))}function Sr(t,n,e,r){var i=t?e.reduce((function(t,e){var i,o,a=e.assignment,s={state:r,action:e,_event:n},u={};if(Ar(a))u=a(t,n.data,s);else try{for(var c=rr(Object.keys(a)),l=c.next();!l.done;l=c.next()){var h=l.value,f=a[h];u[h]=Ar(f)?f(t,n.data,s):f}}catch(t){i={error:t}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}return Object.assign({},t,u)}),t):t;return i}var kr=function(){};function Nr(t){return Array.isArray(t)}function Ar(t){return"function"==typeof t}function Er(t){return"string"==typeof t}function Or(t,n){if(t)return Er(t)?{type:ur,name:t,predicate:n?n[t]:void 0}:Ar(t)?{type:ur,name:t.name,predicate:t}:t}var Mr=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();(ar={})[Mr]=function(){return this},ar[Symbol.observable]=function(){return this};function jr(t){return!!t&&"__xstatenode"in t}var Pr,Dr;function $r(t,n){return Er(t)||"number"==typeof t?nr({type:t},n):t}function Cr(t,n){if(!Er(t)&&"$$type"in t&&"scxml"===t.$$type)return t;var e=$r(t);return nr({name:e.type,data:e,$$type:"scxml",type:"external"},n)}function Tr(t,n){return _r(n).map((function(n){return void 0===n||"string"==typeof n||jr(n)?{target:n,event:t}:nr(nr({},n),{event:t})}))}function Vr(t,n,e,r,i){var o=t.options.guards,a={state:i,cond:n,_event:r};if(n.type===ur)return((null==o?void 0:o[n.name])||n.predicate)(e,r.data,a);var s=null==o?void 0:o[n.type];if(!s)throw new Error("Guard '".concat(n.type,"' is not implemented on machine '").concat(t.id,"'."));return s(e,r.data,a)}function Ir(t,n){return"".concat(t,":invocation[").concat(n,"]")}!function(t){t.Start="xstate.start",t.Stop="xstate.stop",t.Raise="xstate.raise",t.Send="xstate.send",t.Cancel="xstate.cancel",t.NullEvent="",t.Assign="xstate.assign",t.After="xstate.after",t.DoneState="done.state",t.DoneInvoke="done.invoke",t.Log="xstate.log",t.Init="xstate.init",t.Invoke="xstate.invoke",t.ErrorExecution="error.execution",t.ErrorCommunication="error.communication",t.ErrorPlatform="error.platform",t.ErrorCustom="xstate.error",t.Update="xstate.update",t.Pure="xstate.pure",t.Choose="xstate.choose"}(Pr||(Pr={})),function(t){t.Parent="#_parent",t.Internal="#_internal"}(Dr||(Dr={}));var qr=function(t){return"atomic"===t.type||"final"===t.type};function Rr(t){return Object.keys(t.states).map((function(n){return t.states[n]}))}function Lr(t){return Rr(t).filter((function(t){return"history"!==t.type}))}function Xr(t){var n=[t];return qr(t)?n:n.concat(mr(Lr(t).map(Xr)))}function zr(t,n){var e,r,i,o,a,s,u,c,l=Hr(new Set(t)),h=new Set(n);try{for(var f=rr(h),p=f.next();!p.done;p=f.next())for(var d=(S=p.value).parent;d&&!h.has(d);)h.add(d),d=d.parent}catch(t){e={error:t}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(e)throw e.error}}var v=Hr(h);try{for(var y=rr(h),g=y.next();!g.done;g=y.next()){if("compound"!==(S=g.value).type||v.get(S)&&v.get(S).length){if("parallel"===S.type)try{for(var m=(a=void 0,rr(Lr(S))),_=m.next();!_.done;_=m.next()){var x=_.value;h.has(x)||(h.add(x),l.get(x)?l.get(x).forEach((function(t){return h.add(t)})):x.initialStateNodes.forEach((function(t){return h.add(t)})))}}catch(t){a={error:t}}finally{try{_&&!_.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}}else l.get(S)?l.get(S).forEach((function(t){return h.add(t)})):S.initialStateNodes.forEach((function(t){return h.add(t)}))}}catch(t){i={error:t}}finally{try{g&&!g.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}try{for(var w=rr(h),b=w.next();!b.done;b=w.next()){var S;for(d=(S=b.value).parent;d&&!h.has(d);)h.add(d),d=d.parent}}catch(t){u={error:t}}finally{try{b&&!b.done&&(c=w.return)&&c.call(w)}finally{if(u)throw u.error}}return h}function Br(t,n){var e=n.get(t);if(!e)return{};if("compound"===t.type){var r=e[0];if(!r)return{};if(qr(r))return r.key}var i={};return e.forEach((function(t){i[t.key]=Br(t,n)})),i}function Hr(t){var n,e,r=new Map;try{for(var i=rr(t),o=i.next();!o.done;o=i.next()){var a=o.value;r.has(a)||r.set(a,[]),a.parent&&(r.has(a.parent)||r.set(a.parent,[]),r.get(a.parent).push(a))}}catch(t){n={error:t}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(n)throw n.error}}return r}function Gr(t,n){return Br(t,Hr(zr([t],n)))}function Yr(t,n){return Array.isArray(t)?t.some((function(t){return t===n})):t instanceof Set&&t.has(n)}function Fr(t,n){return"compound"===n.type?Lr(n).some((function(n){return"final"===n.type&&Yr(t,n)})):"parallel"===n.type&&Lr(n).every((function(n){return Fr(t,n)}))}function Jr(t){return new Set(mr(t.map((function(t){return t.tags}))))}var Ur=Pr.Start,Wr=Pr.Stop,Kr=Pr.Raise,Qr=Pr.Send,Zr=Pr.Cancel,ti=Pr.NullEvent,ni=Pr.Assign,ei=(Pr.After,Pr.DoneState,Pr.Log),ri=Pr.Init,ii=Pr.Invoke,oi=(Pr.ErrorExecution,Pr.ErrorPlatform,Pr.ErrorCustom,Pr.Update),ai=Pr.Choose,si=Pr.Pure,ui=Cr({type:ri});function ci(t,n){return n&&n[t]||void 0}function li(t,n){var e;if(Er(t)||"number"==typeof t)e=Ar(r=ci(t,n))?{type:t,exec:r}:r||{type:t,exec:void 0};else if(Ar(t))e={type:t.name||t.toString(),exec:t};else{var r;if(Ar(r=ci(t.type,n)))e=nr(nr({},t),{exec:r});else if(r){var i=r.type||t.type;e=nr(nr(nr({},r),t),{type:i})}else e=t}return e}var hi=function(t,n){return t?(Nr(t)?t:[t]).map((function(t){return li(t,n)})):[]};function fi(t){var n=li(t);return nr(nr({id:Er(t)?t:n.id},n),{type:n.type})}function pi(t){return Er(t)?{type:Kr,event:t}:di(t,{to:Dr.Internal})}function di(t,n){return{to:n?n.to:void 0,type:Qr,event:Ar(t)?t:$r(t),delay:n?n.delay:void 0,id:n&&void 0!==n.id?n.id:Ar(t)?t.name:lr(t)}}function vi(t,n){var e="".concat(Pr.DoneState,".").concat(t),r={type:e,data:n,toString:function(){return e}};return r}function yi(t,n,e,r,i,o,a){void 0===a&&(a=!1);var s=a?[]:function(t){var n,e,r=[];try{for(var i=rr(t),o=i.next();!o.done;o=i.next())for(var a=o.value,s=0;s<a.length;)a[s].type!==ni?s++:(r.push(a[s]),a.splice(s,1))}catch(t){n={error:t}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(n)throw n.error}}return r}(i),u=s.length?Sr(e,r,s,n):e,c=a?[e]:void 0,l=[];function h(i){var s;switch(i.type){case Kr:return{type:Kr,_event:Cr(i.event)};case Qr:var h=function(t,n,e,r){var i,o={_event:e},a=Cr(Ar(t.event)?t.event(n,e.data,o):t.event);if(Er(t.delay)){var s=r&&r[t.delay];i=Ar(s)?s(n,e.data,o):s}else i=Ar(t.delay)?t.delay(n,e.data,o):t.delay;var u=Ar(t.to)?t.to(n,e.data,o):t.to;return nr(nr({},t),{to:u,_event:a,event:a.data,delay:i})}(i,u,r,t.options.delays);return o&&h.to!==Dr.Internal&&l.push(h),h;case ei:var f=function(t,n,e){return nr(nr({},t),{value:Er(t.expr)?t.expr:t.expr(n,e.data,{_event:e})})}(i,u,r);return null==o||o(f,u,r),f;case ai:if(!(y=null===(s=i.conds.find((function(e){var i=Or(e.cond,t.options.guards);return!i||Vr(t,i,u,r,o?void 0:n)})))||void 0===s?void 0:s.actions))return[];var p=ir(yi(t,n,u,r,[hi(xr(y),t.options.actions)],o,a),2),d=p[0],v=p[1];return u=v,null==c||c.push(u),d;case si:var y;if(!(y=i.get(u,r.data)))return[];var g=ir(yi(t,n,u,r,[hi(xr(y),t.options.actions)],o,a),2),m=g[0],_=g[1];return u=_,null==c||c.push(u),m;case Wr:f=function(t,n,e){var r=Ar(t.activity)?t.activity(n,e.data):t.activity,i="string"==typeof r?{id:r}:r;return{type:Pr.Stop,activity:i}}(i,u,r);return null==o||o(f,e,r),f;case ni:u=Sr(u,r,[i],o?void 0:n),null==c||c.push(u);break;default:var x=li(i,t.options.actions),w=x.exec;if(o)o(x,u,r);else if(w&&c){var b=c.length-1;x=nr(nr({},x),{exec:function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];w.apply(void 0,or([c[b]],ir(n),!1))}})}return x}}var f=mr(i.map((function(t){var n,e,i=[];try{for(var a=rr(t),s=a.next();!s.done;s=a.next()){var c=h(s.value);c&&(i=i.concat(c))}}catch(t){n={error:t}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(n)throw n.error}}return l.forEach((function(t){o(t,u,r)})),l.length=0,i})));return[f,u]}function gi(t,n){if(t===n)return!0;if(void 0===t||void 0===n)return!1;if(Er(t)||Er(n))return t===n;var e=Object.keys(t),r=Object.keys(n);return e.length===r.length&&e.every((function(e){return gi(t[e],n[e])}))}var mi=function(){function t(t){var n,e,r=this;this.actions=[],this.activities=sr,this.meta={},this.events=[],this.value=t.value,this.context=t.context,this._event=t._event,this._sessionid=t._sessionid,this.event=this._event.data,this.historyValue=t.historyValue,this.history=t.history,this.actions=t.actions||[],this.activities=t.activities||sr,this.meta=(void 0===(e=t.configuration)&&(e=[]),e.reduce((function(t,n){return void 0!==n.meta&&(t[n.id]=n.meta),t}),{})),this.events=t.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=t.configuration,this.transitions=t.transitions,this.children=t.children,this.done=!!t.done,this.tags=null!==(n=Array.isArray(t.tags)?new Set(t.tags):t.tags)&&void 0!==n?n:new Set,this.machine=t.machine,Object.defineProperty(this,"nextEvents",{get:function(){return function(t){return or([],ir(new Set(mr(or([],ir(t.map((function(t){return t.ownEvents}))),!1)))),!1)}(r.configuration)}})}return t.from=function(n,e){return n instanceof t?n.context!==e?new t({value:n.value,context:e,_event:n._event,_sessionid:null,historyValue:n.historyValue,history:n.history,actions:[],activities:n.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):n:new t({value:n,context:e,_event:ui,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},t.create=function(n){return new t(n)},t.inert=function(n,e){if(n instanceof t){if(!n.actions.length)return n;var r=ui;return new t({value:n.value,context:e,_event:r,_sessionid:null,historyValue:n.historyValue,history:n.history,activities:n.activities,configuration:n.configuration,transitions:[],children:{}})}return t.from(n,e)},t.prototype.toStrings=function(t,n){var e=this;if(void 0===t&&(t=this.value),void 0===n&&(n="."),Er(t))return[t];var r=Object.keys(t);return r.concat.apply(r,or([],ir(r.map((function(r){return e.toStrings(t[r],n).map((function(t){return r+n+t}))}))),!1))},t.prototype.toJSON=function(){var t=this;t.configuration,t.transitions;var n=t.tags;t.machine;var e=er(t,["configuration","transitions","tags","machine"]);return nr(nr({},e),{tags:Array.from(n)})},t.prototype.matches=function(t){return cr(t,this.value)},t.prototype.hasTag=function(t){return this.tags.has(t)},t.prototype.can=function(t){var n;kr(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var e=null===(n=this.machine)||void 0===n?void 0:n.getTransitionData(this,t);return!!(null==e?void 0:e.transitions.length)&&e.transitions.some((function(t){return void 0!==t.target||t.actions.length}))},t}(),_i=[];function xi(t){var n;return(n={id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:t}}})[Mr]=function(){return this},n}function wi(t,n,e,r){var i,o,a="string"==typeof(o=t.src)?{type:o}:o,s=null===(i=null==n?void 0:n.options.services)||void 0===i?void 0:i[a.type],u=t.data?wr(t.data,e,r):void 0,c=s?function(t,n,e){var r=xi(n);if(r.deferred=!0,jr(t)){var i=r.state=function(t,n){_i.push(t);var e=n(t);return _i.pop(),e}(void 0,(function(){return(e?t.withContext(e):t).initialState}));r.getSnapshot=function(){return i}}return r}(s,t.id,u):xi(t.id);return c.meta=t,c}function bi(t){if("string"==typeof t){var n={type:t,toString:function(){return t}};return n}return t}function Si(t){return nr(nr({type:ii},t),{toJSON:function(){t.onDone,t.onError;var n=er(t,["onDone","onError"]);return nr(nr({},n),{type:ii,src:bi(t.src)})}})}var ki="",Ni="*",Ai={},Ei=function(t){return"#"===t[0]},Oi=function(){function t(n,e,r,i){void 0===r&&(r="context"in n?n.context:void 0);var o,a=this;this.config=n,this._context=r,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign({actions:{},guards:{},services:{},activities:{},delays:{}},e),this.parent=null==i?void 0:i.parent,this.key=this.config.key||(null==i?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:"."),this.id=this.config.id||or([this.machine.key],ir(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!==(o=this.config.schema)&&void 0!==o?o:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?dr(this.config.states,(function(n,e){var r,i=new t(n,{},void 0,{parent:a,key:e});return Object.assign(a.idMap,nr(((r={})[i.id]=i,r),i.idMap)),i})):Ai;var s=0;!function t(n){var e,r;n.order=s++;try{for(var i=rr(Rr(n)),o=i.next();!o.done;o=i.next()){t(o.value)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}}(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(Array.isArray(this.config.on)?this.config.on.some((function(t){return t.event===ki})):ki in this.config.on),this.strict=!!this.config.strict,this.onEntry=xr(this.config.entry||this.config.onEntry).map((function(t){return li(t)})),this.onExit=xr(this.config.exit||this.config.onExit).map((function(t){return li(t)})),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=xr(this.config.invoke).map((function(t,n){var e,r;if(jr(t)){var i=Ir(a.id,n);return a.machine.options.services=nr(((e={})[i]=t,e),a.machine.options.services),Si({src:i,id:i})}if(Er(t.src)){i=t.id||Ir(a.id,n);return Si(nr(nr({},t),{id:i,src:t.src}))}if(jr(t.src)||Ar(t.src)){i=t.id||Ir(a.id,n);return a.machine.options.services=nr(((r={})[i]=t.src,r),a.machine.options.services),Si(nr(nr({id:i},t),{src:i}))}var o=t.src;return Si(nr(nr({id:Ir(a.id,n)},t),{src:o}))})),this.activities=xr(this.config.activities).concat(this.invoke).map((function(t){return fi(t)})),this.transition=this.transition.bind(this),this.tags=xr(this.config.tags)}return t.prototype._init=function(){this.__cache.transitions||Xr(this).forEach((function(t){return t.on}))},t.prototype.withConfig=function(n,e){var r=this.options,i=r.actions,o=r.activities,a=r.guards,s=r.services,u=r.delays;return new t(this.config,{actions:nr(nr({},i),n.actions),activities:nr(nr({},o),n.activities),guards:nr(nr({},a),n.guards),services:nr(nr({},s),n.services),delays:nr(nr({},u),n.delays)},null!=e?e:this.context)},t.prototype.withContext=function(n){return new t(this.config,this.options,n)},Object.defineProperty(t.prototype,"context",{get:function(){return Ar(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:dr(this.states,(function(t){return t.definition})),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return this.definition},Object.defineProperty(t.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var t=this.transitions;return this.__cache.on=t.reduce((function(t,n){return t[n.eventType]=t[n.eventType]||[],t[n.eventType].push(n),t}),{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),t.prototype.getCandidates=function(t){if(this.__cache.candidates[t])return this.__cache.candidates[t];var n=t===ki,e=this.transitions.filter((function(e){var r=e.eventType===t;return n?r:r||e.eventType===Ni}));return this.__cache.candidates[t]=e,e},t.prototype.getDelayedTransitions=function(){var t=this,n=this.config.after;if(!n)return[];var e=function(n,e){var r=function(t,n){var e=n?"#".concat(n):"";return"".concat(Pr.After,"(").concat(t,")").concat(e)}(Ar(n)?"".concat(t.id,":delay[").concat(e,"]"):n,t.id);return t.onEntry.push(di(r,{delay:n})),t.onExit.push({type:Zr,sendId:r}),r},r=Nr(n)?n.map((function(t,n){var r=e(t.delay,n);return nr(nr({},t),{event:r})})):mr(Object.keys(n).map((function(t,r){var i=n[t],o=Er(i)?{target:i}:i,a=isNaN(+t)?t:+t,s=e(a,r);return xr(o).map((function(t){return nr(nr({},t),{event:s,delay:a})}))})));return r.map((function(n){var e=n.delay;return nr(nr({},t.formatTransition(n)),{delay:e})}))},t.prototype.getStateNodes=function(t){var n,e=this;if(!t)return[];var r=t instanceof mi?t.value:fr(t,this.delimiter);if(Er(r)){var i=this.getStateNode(r).initial;return void 0!==i?this.getStateNodes(((n={})[r]=i,n)):[this,this.states[r]]}var o=Object.keys(r),a=[this];return a.push.apply(a,or([],ir(mr(o.map((function(t){return e.getStateNode(t).getStateNodes(r[t])})))),!1)),a},t.prototype.handles=function(t){var n=lr(t);return this.events.includes(n)},t.prototype.resolveState=function(t){var n=t instanceof mi?t:mi.create(t),e=Array.from(zr([],this.getStateNodes(n.value)));return new mi(nr(nr({},n),{value:this.resolve(n.value),configuration:e,done:Fr(e,this),tags:Jr(e),machine:this.machine}))},t.prototype.transitionLeafNode=function(t,n,e){var r=this.getStateNode(t).next(n,e);return r&&r.transitions.length?r:this.next(n,e)},t.prototype.transitionCompoundNode=function(t,n,e){var r=Object.keys(t),i=this.getStateNode(r[0])._transition(t[r[0]],n,e);return i&&i.transitions.length?i:this.next(n,e)},t.prototype.transitionParallelNode=function(t,n,e){var r,i,o={};try{for(var a=rr(Object.keys(t)),s=a.next();!s.done;s=a.next()){var u=s.value,c=t[u];if(c){var l=this.getStateNode(u)._transition(c,n,e);l&&(o[u]=l)}}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}var h=Object.keys(o).map((function(t){return o[t]})),f=mr(h.map((function(t){return t.transitions})));if(!h.some((function(t){return t.transitions.length>0})))return this.next(n,e);var p=mr(h.map((function(t){return t.entrySet}))),d=mr(Object.keys(o).map((function(t){return o[t].configuration})));return{transitions:f,entrySet:p,exitSet:mr(h.map((function(t){return t.exitSet}))),configuration:d,source:n,actions:mr(Object.keys(o).map((function(t){return o[t].actions})))}},t.prototype._transition=function(t,n,e){return Er(t)?this.transitionLeafNode(t,n,e):1===Object.keys(t).length?this.transitionCompoundNode(t,n,e):this.transitionParallelNode(t,n,e)},t.prototype.getTransitionData=function(t,n){return this._transition(t.value,t,Cr(n))},t.prototype.next=function(t,n){var e,r,i,o=this,a=n.name,s=[],u=[];try{for(var c=rr(this.getCandidates(a)),l=c.next();!l.done;l=c.next()){var h=l.value,f=h.cond,p=h.in,d=t.context,v=!p||(Er(p)&&Ei(p)?t.matches(fr(this.getStateNodeById(p).path,this.delimiter)):cr(fr(p,this.delimiter),yr(this.path.slice(0,-2))(t.value))),y=!1;try{y=!f||Vr(this.machine,f,d,n,t)}catch(t){throw new Error("Unable to evaluate guard '".concat(f.name||f.type,"' in transition for event '").concat(a,"' in state node '").concat(this.id,"':\n").concat(t.message))}if(y&&v){void 0!==h.target&&(u=h.target),s.push.apply(s,or([],ir(h.actions),!1)),i=h;break}}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}if(i){if(!u.length)return{transitions:[i],entrySet:[],exitSet:[],configuration:t.value?[this]:[],source:t,actions:s};var g=mr(u.map((function(n){return o.getRelativeStateNodes(n,t.historyValue)}))),m=!!i.internal,_=[];return m||u.forEach((function(t){_.push.apply(_,or([],ir(o.getExternalReentryNodes(t)),!1))})),{transitions:[i],entrySet:_,exitSet:m?[]:[this],configuration:g,source:t,actions:s}}},t.prototype.getExternalReentryNodes=function(t){for(var n=[],e=ir(t.order>this.order?[t,this]:[this,t],2),r=e[0],i=e[1];r&&r!==i;)n.push(r),r=r.parent;return r!==i?[]:(n.push(i),n)},t.prototype.getActions=function(t,n,e,r,i,o,a){var s,u,c,l,h=this,f=zr([],o?this.getStateNodes(o.value):[this]);try{for(var p=rr(t),d=p.next();!d.done;d=p.next()){(!Yr(f,g=d.value)||Yr(e.entrySet,g.parent)&&!Yr(e.entrySet,g))&&e.entrySet.push(g)}}catch(t){s={error:t}}finally{try{d&&!d.done&&(u=p.return)&&u.call(p)}finally{if(s)throw s.error}}try{for(var v=rr(f),y=v.next();!y.done;y=v.next()){var g;Yr(t,g=y.value)&&!Yr(e.exitSet,g.parent)||e.exitSet.push(g)}}catch(t){c={error:t}}finally{try{y&&!y.done&&(l=v.return)&&l.call(v)}finally{if(c)throw c.error}}var m=mr(e.entrySet.map((function(t){var n=[];if("final"!==t.type)return n;var o=t.parent;if(!o.parent)return n;n.push(vi(t.id,t.doneData),vi(o.id,t.doneData?wr(t.doneData,r,i):void 0));var a=o.parent;return"parallel"===a.type&&Lr(a).every((function(t){return Fr(e.configuration,t)}))&&n.push(vi(a.id)),n})));e.exitSet.sort((function(t,n){return n.order-t.order})),e.entrySet.sort((function(t,n){return t.order-n.order}));var _=new Set(e.entrySet),x=new Set(e.exitSet),w=Array.from(_).map((function(t){var n=t.onEntry,e=t.activities.map((function(t){return function(t){var n=fi(t);return{type:Pr.Start,activity:n,exec:void 0}}(t)}));return hi(a?or(or([],ir(n),!1),ir(e),!1):or(or([],ir(e),!1),ir(n),!1),h.machine.options.actions)})).concat([m.map(pi)]),b=Array.from(x).map((function(t){return hi(or(or([],ir(t.onExit),!1),ir(t.activities.map((function(t){return function(t){var n=Ar(t)?t:fi(t);return{type:Pr.Stop,activity:n,exec:void 0}}(t)}))),!1),h.machine.options.actions)})).concat([hi(e.actions,this.machine.options.actions)]).concat(w);if(n){var S=hi(mr(or([],ir(t),!1).sort((function(t,n){return n.order-t.order})).map((function(t){return t.onExit}))),this.machine.options.actions).filter((function(t){return t.type!==Kr&&(t.type!==Qr||!!t.to&&t.to!==Dr.Internal)}));return b.concat([S])}return b},t.prototype.transition=function(t,n,e,r){void 0===t&&(t=this.initialState);var i,o,a=Cr(n);if(t instanceof mi)i=void 0===e?t:this.resolveState(mi.from(t,e));else{var s=Er(t)?this.resolve(pr(this.getResolvedPath(t))):this.resolve(t),u=null!=e?e:this.machine.context;i=this.resolveState(mi.from(s,u))}if(this.strict&&!this.events.includes(a.name)&&(o=a.name,!/^(done|error)\./.test(o)))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(a.name,"'"));var c=this._transition(i.value,i,a)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:i,actions:[]},l=zr([],this.getStateNodes(i.value)),h=c.configuration.length?zr(l,c.configuration):l;return c.configuration=or([],ir(h),!1),this.resolveTransition(c,i,i.context,r,a)},t.prototype.resolveRaisedTransition=function(t,n,e,r){var i,o=t.actions;return(t=this.transition(t,n,void 0,r))._event=e,t.event=e.data,(i=t.actions).unshift.apply(i,or([],ir(o),!1)),t},t.prototype.resolveTransition=function(t,n,e,r,i){var o,a,s,u,c=this;void 0===i&&(i=ui);var l=t.configuration,h=!n||t.transitions.length>0,f=h?t.configuration:n?n.configuration:[],p=Fr(f,this),d=h?Gr(this.machine,l):void 0,v=n?n.historyValue?n.historyValue:t.source?this.machine.historyValue(n.value):void 0:void 0,y=this.getActions(new Set(f),p,t,e,i,n,r),g=n?nr({},n.activities):{};try{for(var m=rr(y),_=m.next();!_.done;_=m.next()){var x=_.value;try{for(var w=(s=void 0,rr(x)),b=w.next();!b.done;b=w.next()){var S=b.value;S.type===Ur?g[S.activity.id||S.activity.type]=S:S.type===Wr&&(g[S.activity.id||S.activity.type]=!1)}}catch(t){s={error:t}}finally{try{b&&!b.done&&(u=w.return)&&u.call(w)}finally{if(s)throw s.error}}}}catch(t){o={error:t}}finally{try{_&&!_.done&&(a=m.return)&&a.call(m)}finally{if(o)throw o.error}}var k,N,A=ir(yi(this,n,e,i,y,r,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),E=A[0],O=A[1],M=ir(function(t,n){var e,r,i=ir([[],[]],2),o=i[0],a=i[1];try{for(var s=rr(t),u=s.next();!u.done;u=s.next()){var c=u.value;n(c)?o.push(c):a.push(c)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return[o,a]}(E,(function(t){return t.type===Kr||t.type===Qr&&t.to===Dr.Internal})),2),j=M[0],P=M[1],D=E.filter((function(t){var n;return t.type===Ur&&(null===(n=t.activity)||void 0===n?void 0:n.type)===ii})),$=D.reduce((function(t,n){return t[n.activity.id]=wi(n.activity,c.machine,O,i),t}),n?nr({},n.children):{}),C=new mi({value:d||n.value,context:O,_event:i,_sessionid:n?n._sessionid:null,historyValue:d?v?(k=v,N=d,{current:N,states:br(k,N)}):void 0:n?n.historyValue:void 0,history:!d||t.source?n:void 0,actions:d?P:[],activities:d?g:n?n.activities:{},events:[],configuration:f,transitions:t.transitions,children:$,done:p,tags:Jr(f),machine:this}),T=e!==O;C.changed=i.name===oi||T;var V=C.history;V&&delete V.history;var I=!p&&(this._transient||l.some((function(t){return t._transient})));if(!(h||I&&i.name!==ki))return C;var q=C;if(!p)for(I&&(q=this.resolveRaisedTransition(q,{type:ti},i,r));j.length;){var R=j.shift();q=this.resolveRaisedTransition(q,R._event,i,r)}var L=q.changed||(V?!!q.actions.length||T||typeof V.value!=typeof q.value||!gi(q.value,V.value):void 0);return q.changed=L,q.history=V,q},t.prototype.getStateNode=function(t){if(Ei(t))return this.machine.getStateNodeById(t);if(!this.states)throw new Error("Unable to retrieve child state '".concat(t,"' from '").concat(this.id,"'; no child states exist."));var n=this.states[t];if(!n)throw new Error("Child state '".concat(t,"' does not exist on '").concat(this.id,"'"));return n},t.prototype.getStateNodeById=function(t){var n=Ei(t)?t.slice("#".length):t;if(n===this.id)return this;var e=this.machine.idMap[n];if(!e)throw new Error("Child state node '#".concat(n,"' does not exist on machine '").concat(this.id,"'"));return e},t.prototype.getStateNodeByPath=function(t){if("string"==typeof t&&Ei(t))try{return this.getStateNodeById(t.slice(1))}catch(t){}for(var n=hr(t,this.delimiter).slice(),e=this;n.length;){var r=n.shift();if(!r.length)break;e=e.getStateNode(r)}return e},t.prototype.resolve=function(t){var n,e=this;if(!t)return this.initialStateValue||Ai;switch(this.type){case"parallel":return dr(this.initialStateValue,(function(n,r){return n?e.getStateNode(r).resolve(t[r]||n):Ai}));case"compound":if(Er(t)){var r=this.getStateNode(t);return"parallel"===r.type||"compound"===r.type?((n={})[t]=r.initialStateValue,n):t}return Object.keys(t).length?dr(t,(function(t,n){return t?e.getStateNode(n).resolve(t):Ai})):this.initialStateValue||{};default:return t||Ai}},t.prototype.getResolvedPath=function(t){if(Ei(t)){var n=this.machine.idMap[t.slice("#".length)];if(!n)throw new Error("Unable to find state node '".concat(t,"'"));return n.path}return hr(t,this.delimiter)},Object.defineProperty(t.prototype,"initialStateValue",{get:function(){var t,n;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)n=vr(this.states,(function(t){return t.initialStateValue||Ai}),(function(t){return!("history"===t.type)}));else if(void 0!==this.initial){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));n=qr(this.states[this.initial])?this.initial:((t={})[this.initial]=this.states[this.initial].initialStateValue,t)}else n={};return this.__cache.initialStateValue=n,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),t.prototype.getInitialState=function(t,n){this._init();var e=this.getStateNodes(t);return this.resolveTransition({configuration:e,entrySet:e,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,null!=n?n:this.machine.context,void 0)},Object.defineProperty(t.prototype,"initialState",{get:function(){var t=this.initialStateValue;if(!t)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){var t;if("history"===this.type){var n=this.config;t=Er(n.target)&&Ei(n.target)?pr(this.machine.getStateNodeById(n.target).path.slice(this.path.length-1)):n.target}return t},enumerable:!1,configurable:!0}),t.prototype.getRelativeStateNodes=function(t,n,e){return void 0===e&&(e=!0),e?"history"===t.type?t.resolveHistory(n):t.initialStateNodes:[t]},Object.defineProperty(t.prototype,"initialStateNodes",{get:function(){var t=this;return qr(this)?[this]:"compound"!==this.type||this.initial?mr(gr(this.initialStateValue).map((function(n){return t.getFromRelativePath(n)}))):[this]},enumerable:!1,configurable:!0}),t.prototype.getFromRelativePath=function(t){if(!t.length)return[this];var n=ir(t),e=n[0],r=n.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(e,"' from node with no states"));var i=this.getStateNode(e);if("history"===i.type)return i.resolveHistory();if(!this.states[e])throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return this.states[e].getFromRelativePath(r)},t.prototype.historyValue=function(t){if(Object.keys(this.states).length)return{current:t||this.initialStateValue,states:vr(this.states,(function(n,e){if(!t)return n.historyValue();var r=Er(t)?void 0:t[e];return n.historyValue(r||n.initialStateValue)}),(function(t){return!t.history}))}},t.prototype.resolveHistory=function(t){var n=this;if("history"!==this.type)return[this];var e=this.parent;if(!t){var r=this.target;return r?mr(gr(r).map((function(t){return e.getFromRelativePath(t)}))):e.initialStateNodes}var i,o,a=(i=e.path,o="states",function(t){var n,e,r=t;try{for(var a=rr(i),s=a.next();!s.done;s=a.next()){var u=s.value;r=r[o][u]}}catch(t){n={error:t}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(n)throw n.error}}return r})(t).current;return Er(a)?[e.getStateNode(a)]:mr(gr(a).map((function(t){return"deep"===n.history?e.getFromRelativePath(t):[e.states[t[0]]]})))},Object.defineProperty(t.prototype,"stateIds",{get:function(){var t=this,n=mr(Object.keys(this.states).map((function(n){return t.states[n].stateIds})));return[this.id].concat(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){var t,n,e,r;if(this.__cache.events)return this.__cache.events;var i=this.states,o=new Set(this.ownEvents);if(i)try{for(var a=rr(Object.keys(i)),s=a.next();!s.done;s=a.next()){var u=i[s.value];if(u.states)try{for(var c=(e=void 0,rr(u.events)),l=c.next();!l.done;l=c.next()){var h=l.value;o.add("".concat(h))}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}}}catch(n){t={error:n}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ownEvents",{get:function(){var t=new Set(this.transitions.filter((function(t){return!(!t.target&&!t.actions.length&&t.internal)})).map((function(t){return t.eventType})));return Array.from(t)},enumerable:!1,configurable:!0}),t.prototype.resolveTarget=function(t){var n=this;if(void 0!==t)return t.map((function(t){if(!Er(t))return t;var e=t[0]===n.delimiter;if(e&&!n.parent)return n.getStateNodeByPath(t.slice(1));var r=e?n.key+t:t;if(!n.parent)return n.getStateNodeByPath(r);try{return n.parent.getStateNodeByPath(r)}catch(t){throw new Error("Invalid transition definition for state node '".concat(n.id,"':\n").concat(t.message))}}))},t.prototype.formatTransition=function(t){var n=this,e=function(t){if(void 0!==t&&""!==t)return xr(t)}(t.target),r="internal"in t?t.internal:!e||e.some((function(t){return Er(t)&&t[0]===n.delimiter})),i=this.machine.options.guards,o=this.resolveTarget(e),a=nr(nr({},t),{actions:hi(xr(t.actions)),cond:Or(t.cond,i),target:o,source:this,internal:r,eventType:t.event,toJSON:function(){return nr(nr({},a),{target:a.target?a.target.map((function(t){return"#".concat(t.id)})):void 0,source:"#".concat(n.id)})}});return a},t.prototype.formatTransitions=function(){var t,n,e,r=this;if(this.config.on)if(Array.isArray(this.config.on))e=this.config.on;else{var i=this.config.on,o=Ni,a=i[o],s=void 0===a?[]:a,u=er(i,["*"]);e=mr(Object.keys(u).map((function(t){var n=Tr(t,u[t]);return n})).concat(Tr(Ni,s)))}else e=[];var c=this.config.always?Tr("",this.config.always):[],l=this.config.onDone?Tr(String(vi(this.id)),this.config.onDone):[];var h=mr(this.invoke.map((function(t){var n=[];return t.onDone&&n.push.apply(n,or([],ir(Tr(String(function(t,n){var e="".concat(Pr.DoneInvoke,".").concat(t);return{type:e,data:n,toString:function(){return e}}}(t.id)),t.onDone)),!1)),t.onError&&n.push.apply(n,or([],ir(Tr(String(function(t,n){var e="".concat(Pr.ErrorPlatform,".").concat(t);return{type:e,data:n,toString:function(){return e}}}(t.id)),t.onError)),!1)),n}))),f=this.after,p=mr(or(or(or(or([],ir(l),!1),ir(h),!1),ir(e),!1),ir(c),!1).map((function(t){return xr(t).map((function(t){return r.formatTransition(t)}))})));try{for(var d=rr(f),v=d.next();!v.done;v=d.next()){var y=v.value;p.push(y)}}catch(n){t={error:n}}finally{try{v&&!v.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return p},t}();function Mi(t,n){return new Oi(t,n)}var ji=function(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,i,o=e.call(t),a=[];try{for(;(void 0===n||n-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(i)throw i.error}}return a},Pi=function(t,n,e){if(e||2===arguments.length)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return t.concat(r||Array.prototype.slice.call(n))};function Di(t){var n;return(n=[]).concat.apply(n,Pi([],ji(t),!1))}function $i(t){return t.states?Object.keys(t.states).map((function(n){return t.states[n]})):[]}function Ci(t){var n=Di(t.transitions.map((function(n,e){return(n.target?n.target:[t]).map((function(r,i){var o={id:"".concat(t.id,":").concat(e,":").concat(i),source:t,target:r,transition:n,label:{text:n.eventType,toJSON:function(){return{text:n.eventType}}},toJSON:function(){var n=o.label;return{source:t.id,target:r.id,label:n}}};return o}))}))),e={id:t.id,stateNode:t,children:$i(t).map(Ci),edges:n,toJSON:function(){return{id:e.id,children:e.children,edges:e.edges}}};return e}var Ti=function(t,n,e,r){return new(e||(e=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,s)}u((r=r.apply(t,n||[])).next())}))};class Vi{constructor(){this.selectedHubID="",this.machineDef=void 0,this.state=""}static validateLifecycleDefinition(t){if(!t)throw new Error("Definition is empty");try{const n=JSON.parse(t);Ci(Mi(n))}catch(t){return!1}return!0}loadData(t){return new Promise(((n,e)=>{Vi.validateLifecycleDefinition(t)||e("Invalid machine definition"),this.machineDef=JSON.parse(t),this.machine=Mi(this.machineDef),this.graph=Ci(this.machine),this.updateState(this.machine.initialState),n(this)}))}loadUrl(t){return Ti(this,void 0,void 0,(function*(){return this.machineDef=yield function(t,n){return fetch(t,n).then(De)}(t),this.machine=Mi(this.machineDef),this.graph=Ci(this.machine),this.updateState(this.machine.initialState),this}))}updateState(t){this.state=t}}return n})()));
//# sourceMappingURL=index.js.map